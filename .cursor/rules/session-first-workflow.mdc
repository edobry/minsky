---
description: description: REQUIRED when making any code, test, config, or doc change for a task in a session workspace
globs: 
alwaysApply: false
---
# Session-First Workflow

**Purpose:**  
To ensure all code, test, and configuration changes for a task are made exclusively within the session workspace, maintaining strict isolation and traceability as required by the Minsky workflow.

---

## 1. Scope and Applicability

- **All changes** (code, tests, configs, fixtures, docs, etc.) related to a task MUST be made **directly within the session workspace** for that task.
- This applies to any file that could affect the outcome of tests, builds, or reviews, including test files, fixtures, helper scripts, and configuration files.
- **No edits to the main workspace are allowed** during an active session, except for the final merge after review.

## 2. Workflow Enforcement

- **Session workspace** is a full, isolated clone of the repository, created and managed by the Minsky CLI.
- All edits, commits, and pushes must be performed from within the session workspace.
- **Never copy files from the main workspace into the session workspace.**  
  The session workspace already contains all project files as of the session's creation or last update.
- **Never copy files from the session workspace back to the main workspace manually.**  
  All changes must be merged via the session branch after review.

## 3. Edit Location Verification

- Before any file edit, verify that the file path is within the session workspace directory.
- Any attempt to edit a file outside the session workspace is a hard error and must be aborted immediately.

## 4. No Temporary or Test-Only Main Workspace Changes

- **No "temporary" or "test-only" changes in the main workspace are permitted.**
- All test expectation, fixture, and helper file changes must be made in the session workspace.

## 5. Audit and Logging

- Every file edit must log the absolute path being edited and the current session directory, both in the AI's output and (optionally) in a `.session-edit-log` file in the session directory.

## 6. Automated Enforcement

- Automated tools and contributors must check that all changes for a task are present only in the session workspace until the session is merged.

## 7. Rationale

- This ensures all work is traceable, reviewable, and isolated to the session, preventing accidental pollution or loss of context in the main workspace.
- It guarantees that the main workspace remains stable and unaffected by in-progress work.

---

### Rule Description (for discoverability and relevance)

**Description:**  
This rule applies to all code, test, configuration, fixture, and documentation changes for a task.  
It requires that all such changes be made exclusively within the session workspace created by the Minsky CLI, which is a full, isolated clone of the repository.  
No changes may be made to the main workspace during an active session, except for the final merge after review.  
This rule is relevant to any operation that could affect the outcome of tests, builds, or code reviews for a task, including but not limited to source code, test files, fixtures, and configuration files.
