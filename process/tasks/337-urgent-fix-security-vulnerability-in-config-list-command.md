# URGENT: Fix security vulnerability in config list command

## Context

The config list command currently exposes full API keys and GitHub tokens in plain text, creating a critical security risk.

SECURITY ISSUE:

- API keys displayed: sk-proj-[REDACTED-FOR-SECURITY]...
- GitHub tokens exposed: github*pat*[REDACTED-FOR-SECURITY]

REQUIRED FIXES:

- Mask API keys and tokens in config list output (show **\*\*\*** (configured) instead)
- Add --show-secrets flag for intentional credential exposure when needed
- Apply same safe credential handling pattern as the enhanced config show command
- Ensure no credentials leak in any config command output by default

PRIORITY: Critical security fix - should be addressed immediately

## Requirements

✅ Mask all sensitive credentials by default in config list output
✅ Add --show-secrets flag for intentional credential exposure
✅ Apply consistent credential masking across CLI and MCP interfaces
✅ Show security warnings when credentials are masked
✅ Follow same pattern as config show command

## Solution

**IMPLEMENTED COMPREHENSIVE SECURITY FIX:**

### 1. CLI Config List Command (`src/commands/config/list.ts`)

- Added `--show-secrets` flag with explicit security warning
- Implemented `maskCredentials()` function for safe credential handling
- Added security notice when credentials are masked
- Masks API keys, tokens, and connection strings by default

### 2. MCP Config List Command (`src/adapters/shared/commands/config.ts`)

- Added `showSecrets` parameter with boolean schema
- Implemented same credential masking logic
- Returns `credentialsMasked` flag in response
- Consistent with config show command pattern

### 3. Output Formatting (`src/adapters/cli/customizations/config-customizations.ts`)

- Enhanced credential detection for comprehensive coverage
- Added security notice display when credentials are masked
- Improved formatting for masked credentials

### Security Features:

- **Default Security**: All credentials masked by default
- **Explicit Override**: `--show-secrets` flag available when needed
- **Clear Feedback**: Users informed about masking with usage instructions
- **Comprehensive Coverage**: API keys, GitHub tokens, connection strings, secrets

### Before/After:

**❌ BEFORE (Security Risk):**

```
ai.providers.openai.apiKey=sk-proj-[CREDENTIALS-EXPOSED-IN-PLAIN-TEXT]
github.token=github_pat_[CREDENTIALS-EXPOSED-IN-PLAIN-TEXT]
```

**✅ AFTER (Secure):**

```
ai.providers.openai.apiKey=******************** (configured)
github.token=******************** (configured)

⚠️  Credentials are masked for security. Use --show-secrets to reveal actual values.
```

## Notes

**CRITICAL SECURITY VULNERABILITY RESOLVED** ✅

The security fix has been successfully implemented and tested. API keys, GitHub tokens, and other sensitive credentials are now safely masked by default in all config list output, preventing accidental exposure in terminal sessions, logs, or screenshots.

**Status:** Ready for PR creation and review
